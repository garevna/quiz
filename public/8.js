(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[8],{

/***/ "./components/registration.js":
/*!************************************!*\
  !*** ./components/registration.js ***!
  \************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var MODULES_js_sha256__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! MODULES/js-sha256 */ \"./node_modules/js-sha256/src/sha256.js\");\n/* harmony import */ var MODULES_js_sha256__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(MODULES_js_sha256__WEBPACK_IMPORTED_MODULE_0__);\n\n\n\nconst SignUpComponent = ('sign-up-component', {\n  data() {\n    return {\n      cardClass: \"mb-8 py-5 px-12 dark-card\",\n      cardHeight: 150,\n      stepperColor: \"#590\",\n      logins: null,\n      newUser: false,\n      password: \"\",\n      showPassText: false,\n      color: \"#09b\",\n      user: {\n        name: \"\",\n        lastName: \"\",\n        password: \"\",\n        passHash: \"\",\n        avatar: null\n      },\n      registered: false,\n      stage: 0,\n      backIcon: 'chevron_left',\n      backIconColor: \"#09b\",\n      theFile: null,\n      avatar: \"https://www.themelister.com/templates/nabster/dleimages/noavatar.png\"\n    };\n  },\n\n  computed: {\n    validLogin: function () {\n      return this.user && this.user.login && this.logins.filter(login => login.indexOf(this.user.login) !== -1).length === 0;\n    },\n    loginHint: function () {\n      return !this.user.login ? \"\" : this.validLogin ? \"Valid\" : `User ${this.user.login} already exists`;\n    },\n    loginColor: function () {\n      return this.validLogin ? \"#09b\" : \"#fa0\";\n    },\n    passwordLabel: function () {\n      return `Password for ${this.user.login}`;\n    },\n    passColor: function () {\n      return !this.user ? \"#f00\" : this.user.password.length < 8 ? \"#f00\" : !this.user.password.match(/[A-Z]/g) ? \"#f50\" : !this.user.password.match(/[a-z]/g) ? \"#e70\" : !this.user.password.match(/[0-9]/g) ? \"#d90\" : \"#09b\";\n    },\n    passHint: function () {\n      return !this.user ? \"\" : this.user.password.length < 8 ? \"There must be at least 8 characters\" : !this.user.password.match(/[A-Z]/g) ? \"There must be at least one character in upper case\" : !this.user.password.match(/[a-z]/g) ? \"There must be at least one character in lower case\" : !this.user.password.match(/[0-9]/g) ? \"There must be at least one digit\" : \"correct password\";\n    },\n    duplicatePassColor: function () {\n      return this.user.password !== this.password ? \"#f50\" : \"#09b\";\n    },\n    duplicatePassHint: function () {\n      return this.user.password !== this.password ? \"incorrect\" : \"correct\";\n    },\n    avatarHint: function () {\n      return !this.theFile ? \"Upload file\" : this.theFile.type.indexOf(\"image\") === -1 ? \"Selected file is not image\" : this.theFile.size < 300000 ? \"\" + this.theFile.size : \"Avatar size must be less then 300Kb\";\n    },\n    validFile: function () {\n      return !!this.theFile && this.theFile.type.indexOf(\"image\") !== -1 && this.theFile.size < 300000;\n    },\n    avatarColor: function () {\n      return this.validFile ? \"#09b\" : \"#f50\";\n    }\n  },\n  methods: {\n    async getLogins() {\n      this.logins = Object.keys((await (await fetch(\"https://garevna-js-quiz.glitch.me/forms/all\")).json()));\n    },\n\n    showPicture() {\n      if (this.validFile) {\n        this.avatar = URL.createObjectURL(this.theFile);\n      }\n    },\n\n    exit() {\n      this.$root.$emit(\"sign-up-finished\");\n    },\n\n    saveUserData() {\n      this.user.passHash = Object(MODULES_js_sha256__WEBPACK_IMPORTED_MODULE_0__[\"sha256\"])(this.user.password);\n      delete this.user.password;\n      let login = this.user.login;\n      delete this.user.login;\n      this.user.registered = new Date().toLocaleDateString();\n      this.user.results = JSON.stringify({});\n      let formData = new FormData();\n\n      for (let prop in this.user) {\n        formData.set(prop, this.user[prop]);\n      }\n\n      formData.set(\"avatar\", this.theFile);\n      fetch(`https://garevna-js-quiz.glitch.me/form/${login}`, {\n        method: \"POST\",\n        body: formData\n      }).then(response => {\n        if (response.ok) {\n          document.cookie = `user=${login}`;\n          document.cookie = `pass=${this.user.passHash}`;\n          this.$root.$store.commit('setUser', {\n            login: login,\n            fname: this.user.lastName,\n            name: this.user.name,\n            registered: new Date().toLocaleDateString(),\n            photoURL: URL.createObjectURL(this.theFile),\n            passHash: this.user.passHash\n          });\n        }\n      });\n    }\n\n  },\n\n  created() {\n    this.getLogins().then(() => this.stage = 1);\n  },\n\n  template: `\n  <v-container fluid fill-height>\n   <v-stepper v-model=\"stage\" dark\n              class=\"dark-card mx-auto\"\n              v-if=\"user\">\n    <v-stepper-header dark>\n          <v-stepper-step :complete=\"validLogin\"\n                          step=\"1\"\n                          :color=\"stepperColor\">\n          </v-stepper-step>\n\n      <v-divider></v-divider>\n\n          <v-stepper-step :complete=\"stage > 2\"\n                          step=\"2\"\n                          :color=\"stepperColor\">\n          </v-stepper-step>\n\n      <v-divider></v-divider>\n\n          <v-stepper-step :complete=\"stage > 3\"\n                          step=\"3\"\n                          :color=\"stepperColor\">\n          </v-stepper-step>\n\n\n      <v-divider></v-divider>\n\n          <v-stepper-step :complete=\"stage > 4\"\n                          step=\"4\"\n                          :color=\"stepperColor\">\n          </v-stepper-step>\n\n      <v-divider></v-divider>\n\n          <v-stepper-step :complete=\"stage > 5\"\n                          step=\"5\"\n                          :color=\"stepperColor\">\n          </v-stepper-step>\n\n      <v-divider></v-divider>\n\n          <v-stepper-step :complete=\"stage > 6\"\n                          step=\"6\"\n                          :color=\"stepperColor\">\n          </v-stepper-step>\n\n    </v-stepper-header>\n\n    <v-stepper-items class=\"transparent\" dark>\n      <v-stepper-content step=\"1\" v-if=\"logins\">\n        <v-card :class=\"cardClass\"\n                :height=\"cardHeight\">\n          <v-text-field v-model=\"user.login\"\n                        :hint=\"loginHint\"\n                        label=\"User login\"\n                        :color=\"loginColor\">\n          </v-text-field>\n        </v-card>\n\n        <v-btn class=\"transparent\"\n               v-if=\"validLogin\"\n               @click=\"stage = 2\">\n          Continue\n        </v-btn>\n\n        <v-btn transparent text @click=\"exit\">Cancel</v-btn>\n      </v-stepper-content>\n\n      <v-stepper-content step=\"2\">\n        <v-card :class=\"cardClass\"\n                :height=\"cardHeight\">\n          <v-text-field v-model=\"user.name\"\n                        autofocus\n                        outlined\n                        label=\"name\"\n                        hint=\"Your name\"\n                        color=\"#09b\">\n        </v-text-field>\n        </v-card>\n\n        <v-btn class=\"transparent\"\n               v-if=\"user.name.length > 1\"\n               @click=\"stage = 3\">\n          Continue\n        </v-btn>\n\n        <v-btn transparent text @click=\"exit\">Cancel</v-btn>\n      </v-stepper-content>\n\n      <v-stepper-content step=\"3\">\n        <v-card :class=\"cardClass\"\n                :height=\"cardHeight\">\n          <v-text-field v-model=\"user.lastName\"\n                        autofocus\n                        outlined\n                        hint=\"last name\"\n                        label=\"Your family name\"\n                        color=\"#09b\">\n          </v-text-field>\n        </v-card>\n\n        <v-btn class=\"transparent\"\n               v-if=\"user.lastName.length > 2\"\n               @click=\"stage = 4\">\n          Continue\n        </v-btn>\n\n        <v-btn transparent text @click=\"exit\">Cancel</v-btn>\n      </v-stepper-content>\n\n      <v-stepper-content step=\"4\">\n        <v-card :class=\"cardClass\"\n                :height=\"cardHeight\">\n          <v-text-field v-model=\"user.password\"\n                        autofocus\n                        :hint=\"passHint\"\n                        :label=\"passwordLabel\"\n                        :append-icon=\"showPassText ? 'mdi-eye' : 'mdi-eye-off'\"\n                        :type=\"showPassText ? 'text' : 'password'\"\n                        @click:append=\"showPassText = !showPassText\"\n                        :color=\"passColor\">\n          </v-text-field>\n        </v-card>\n\n        <v-btn class=\"transparent\"\n               v-if=\"passHint === 'correct password'\"\n               @click=\"stage = 5\">\n          Continue\n        </v-btn>\n\n        <v-btn transparent text @click=\"exit\">Cancel</v-btn>\n      </v-stepper-content>\n\n      <v-stepper-content step=\"5\">\n        <v-card :class=\"cardClass\"\n                :height=\"cardHeight\">\n          <v-text-field v-model=\"password\"\n                        autofocus\n                        :hint=\"duplicatePassHint\"\n                        :label=\"passwordLabel\"\n                        :append-icon=\"showPassText ? 'mdi-eye' : 'mdi-eye-off'\"\n                        :type=\"showPassText ? 'text' : 'password'\"\n                        @click:append=\"showPassText = !showPassText\"\n                        :color=\"duplicatePassColor\">\n          </v-text-field>\n        </v-card>\n\n        <v-btn class=\"transparent\"\n               v-if=\"duplicatePassHint === 'correct'\"\n               @click=\"stage = 6\">\n          Continue\n        </v-btn>\n\n        <v-btn transparent text @click=\"exit\">Cancel</v-btn>\n      </v-stepper-content>\n\n      <v-stepper-content step=\"6\">\n        <v-card :class=\"cardClass\"\n                :height=\"cardHeight\">\n          <v-avatar size=\"58\">\n              <v-img :src=\"avatar\"></v-img>\n          </v-avatar>\n          <v-file-input label=\"Avatar\" dense\n                        class=\"transparent\"\n                        v-model=\"theFile\"\n                        :hint=\"avatarHint\"\n                        :color=\"avatarColor\"\n                        @change=\"showPicture\"\n                        prepend-icon=\"create\"\n                        show-size\n                        color=\"#09b\">\n\n          </v-file-input>\n        </v-card>\n\n        <v-btn class=\"transparent\"\n               v-if=\"duplicatePassHint === 'correct'\"\n               @click=\"saveUserData\">\n          Submit\n        </v-btn>\n\n        <v-btn transparent text @click=\"exit\">Cancel</v-btn>\n      </v-stepper-content>\n\n    </v-stepper-items>\n  </v-stepper>\n</v-container>\n  `\n});\n/* harmony default export */ __webpack_exports__[\"default\"] = (SignUpComponent);\n\n//# sourceURL=webpack:///./components/registration.js?");

/***/ })

}]);